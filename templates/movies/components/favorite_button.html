{% if user.is_authenticated %}
    {% if es_favorito %}
        <button 
            type="button"
            hx-post="{% url 'movies:toggle_favorite' pelicula.id %}"
            hx-target="this"
            hx-swap="outerHTML"
            aria-label="Quitar {{ pelicula.titulo }} de favoritos"
            aria-pressed="true"
            class="flex items-center gap-2 bg-dark-gray px-6 py-3 rounded-lg font-bold hover:bg-gray-700 transition border-2 border-white focus:outline-none focus:ring-2 focus:ring-hbo-blue">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                <path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"/>
            </svg>
            <span>En favoritos</span>
        </button>
    {% else %}
        <button 
            type="button"
            hx-post="{% url 'movies:toggle_favorite' pelicula.id %}"
            hx-target="this"
            hx-swap="outerHTML"
            aria-label="Agregar {{ pelicula.titulo }} a favoritos"
            aria-pressed="false"
            class="flex items-center gap-2 bg-dark-gray px-6 py-3 rounded-lg font-bold hover:bg-gray-700 transition border-2 border-gray-600 focus:outline-none focus:ring-2 focus:ring-hbo-blue">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
            </svg>
            <span>Agregar a favoritos</span>
        </button>
    {% endif %}
{% else %}
    <div class="text-sm text-gray-400 py-3" role="status">
        <a href="{% url 'movies:login' %}" class="text-hbo-blue hover:underline focus:outline-none focus:ring-2 focus:ring-hbo-blue rounded">
            Inicia sesi√≥n
        </a> para agregar a favoritos
    </div>
{% endif %}